@model IEnumerable<dynamic>
@{
    ViewData["Title"] = "Bảng Xếp Hạng Đại Gia";
}

<div class="container mt-5 pb-5">
    <div class="mb-4">
        <a asp-controller="Home" asp-action="Index" class="btn btn-light rounded-pill px-4 shadow-sm border">
            <i class="fa-solid fa-arrow-left-long me-2"></i> Trở lại trang chủ
        </a>
    </div>

    <div class="text-center mb-5">
        <div class="d-inline-block position-relative mb-4">
            <div class="bg-vinh-danh shadow-lg animate-pulse">
                <i class="fa-solid fa-trophy text-white"></i>
            </div>
            <div class="confetti-icon top-0 start-100">✨</div>
            <div class="confetti-icon bottom-0 start-0">⭐</div>
        </div>

        <h2 class="fw-900 text-uppercase tracking-wider mb-2 color-gradient">Bảng Xếp Hạng Đại Gia</h2>
        <p class="text-muted mx-auto fs-6" style="max-width: 600px;">
            Hệ thống tự động vinh danh những quý khách hàng có đóng góp lớn nhất.
            Cảm ơn bạn đã đồng hành cùng <span class="text-primary fw-bold">Nick3s.Shop</span>!
        </p>
    </div>

    <div class="row justify-content-center">
        <div class="col-lg-10 col-xl-9">
            <div class="card border-0 shadow-2xl rounded-5 overflow-hidden">
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0">
                        <thead class="header-gradient text-white border-0">
                            <tr>
                                <th class="text-center py-4 px-4 border-0" style="width: 120px;">VỊ THẾ</th>
                                <th class="py-4 border-0">THÀNH VIÊN</th>
                                <th class="text-end py-4 px-5 border-0">TỔNG NẠP</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white">
                            @{
                                int rank = 1;
                            }
                            @foreach (var user in Model)
                            {
                                <tr class="rank-row-modern @(rank <= 3 ? "top-rank" : "")">
                                    <td class="text-center py-4 px-4">
                                        @if (rank == 1)
                                        {
                                            <div class="rank-box gold-glow"><i class="fa-solid fa-crown"></i></div>
                                        }
                                        else if (rank == 2)
                                        {
                                            <div class="rank-box silver-glow">2</div>
                                        }
                                        else if (rank == 3)
                                        {
                                            <div class="rank-box bronze-glow">3</div>
                                        }
                                        else
                                        {
                                            <span class="rank-number">#@rank</span>
                                        }
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <div class="position-relative me-3">
                                                <img src="https://ui-avatars.com/api/?name=@(user.DisplayName)&background=random&color=fff&bold=true&size=128"
                                                     class="avatar-img shadow-sm" />
                                                @if (rank == 1)
                                                {
                                                    <span class="fire-badge">🔥</span>
                                                }
                                            </div>
                                            <div>
                                                <div class="fw-800 fs-6 @(rank == 1 ? "text-warning" : "text-dark")">@user.DisplayName</div>
                                                <div class="x-small-tag">
                                                    <i class="fa-solid fa-shield-check me-1"></i> Đã xác minh
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="text-end py-4 px-5 text-nowrap">
                                        <span class="amount-text">@user.Balance.ToString("#,##0")</span>
                                        <span class="currency">đ</span>
                                    </td>
                                </tr>
                                rank++;
                            }
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="text-center mt-5">
                <a asp-controller="Home" asp-action="Deposit" class="btn btn-primary btn-lg rounded-pill px-5 py-3 fw-bold shadow-lg btn-nạp">
                    NẠP TIỀN ĐUA TOP NGAY <i class="fa-solid fa-circle-arrow-up ms-2"></i>
                </a>
                <div class="mt-4">
                    <p class="small text-muted italic">
                        <i class="fa-solid fa-circle-info me-1"></i>
                        Thông tin được bảo mật và ẩn danh một phần để bảo vệ quyền riêng tư của khách hàng.
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    :root {
        --gold: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
        --silver: linear-gradient(135deg, #E0E0E0 0%, #BDBDBD 100%);
        --bronze: linear-gradient(135deg, #F4A460 0%, #8B4513 100%);
        --primary-gradient: linear-gradient(135deg, #0061ff 0%, #6033ff 100%);
    }

    .fw-900 {
        font-weight: 900;
    }

    .fw-800 {
        font-weight: 800;
    }

    .rounded-5 {
        border-radius: 2rem !important;
    }

    .tracking-wider {
        letter-spacing: 2px;
    }

    /* Custom Header */
    .bg-vinh-danh {
        width: 100px;
        height: 100px;
        background: var(--primary-gradient);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 3rem;
    }

    .color-gradient {
        background: linear-gradient(135deg, #1a202c 0%, #4a5568 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .header-gradient {
        background: var(--primary-gradient);
    }

    /* Rank Rows */
    .rank-row-modern {
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        border-bottom: 1px solid #f1f5f9;
    }

        .rank-row-modern:hover {
            background-color: #f8fbff !important;
            transform: scale(1.02) translateX(10px);
            z-index: 5;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
        }

    .top-rank {
        background-color: #fffdf5;
    }

    /* Rank Box */
    .rank-box {
        width: 45px;
        height: 45px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto;
        color: white;
        font-weight: 900;
        font-size: 1.2rem;
    }

    .gold-glow {
        background: var(--gold);
        box-shadow: 0 0 15px rgba(255, 215, 0, 0.4);
    }

    .silver-glow {
        background: var(--silver);
        box-shadow: 0 0 15px rgba(192, 192, 192, 0.4);
    }

    .bronze-glow {
        background: var(--bronze);
        box-shadow: 0 0 15px rgba(205, 127, 50, 0.4);
    }

    .rank-number {
        font-weight: 800;
        color: #cbd5e0;
        font-size: 1.1rem;
    }

    /* Avatar & Badge */
    .avatar-img {
        width: 55px;
        height: 55px;
        border-radius: 18px;
        border: 3px solid #fff;
    }

    .fire-badge {
        position: absolute;
        bottom: -8px;
        right: -8px;
        background: white;
        border-radius: 50%;
        width: 25px;
        height: 25px;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }

    .x-small-tag {
        font-size: 0.7rem;
        color: #10b981;
        font-weight: 600;
        background: #ecfdf5;
        padding: 2px 8px;
        border-radius: 6px;
        display: inline-block;
        margin-top: 2px;
    }

    /* Text */
    .amount-text {
        font-weight: 900;
        font-size: 1.4rem;
        color: #e53e3e;
    }

    .currency {
        font-weight: 700;
        color: #e53e3e;
        margin-left: 2px;
    }

    /* Button effects */
    .btn-nạp {
        transition: all 0.3s;
        border: none;
        background: var(--primary-gradient);
    }

        .btn-nạp:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(0, 97, 255, 0.3) !important;
            filter: brightness(1.1);
        }

    .confetti-icon {
        position: absolute;
        font-size: 1.5rem;
    }

    @@keyframes pulse {
        0% {
            transform: scale(1);
            box-shadow: 0 0 0 0 rgba(0, 97, 255, 0.4);
        }

        70% {
            transform: scale(1.05);
            box-shadow: 0 0 0 20px rgba(0, 97, 255, 0);
        }

        100% {
            transform: scale(1);
            box-shadow: 0 0 0 0 rgba(0, 97, 255, 0);
        }
    }

    .animate-pulse {
        animation: pulse 2s infinite;
    }
</style>